<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>centeos 安装 docker | Warren&#39;s</title>
    <meta name="description" content="blog &amp; note">
    <link rel="icon" href="/blog/favicon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.fe5bdb75.css" as="style"><link rel="preload" href="/blog/assets/js/app.a3fab05b.js" as="script"><link rel="preload" href="/blog/assets/js/2.8013534f.js" as="script"><link rel="preload" href="/blog/assets/js/50.6c7a2ef7.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.53ff2caf.js"><link rel="prefetch" href="/blog/assets/js/11.4935f015.js"><link rel="prefetch" href="/blog/assets/js/12.d6ae9e0a.js"><link rel="prefetch" href="/blog/assets/js/13.26cdd5ab.js"><link rel="prefetch" href="/blog/assets/js/14.074ed238.js"><link rel="prefetch" href="/blog/assets/js/15.cc53453a.js"><link rel="prefetch" href="/blog/assets/js/16.b1284d0a.js"><link rel="prefetch" href="/blog/assets/js/17.4451e3ed.js"><link rel="prefetch" href="/blog/assets/js/18.fbfbe9e1.js"><link rel="prefetch" href="/blog/assets/js/19.a60c4380.js"><link rel="prefetch" href="/blog/assets/js/20.5f5ca6bc.js"><link rel="prefetch" href="/blog/assets/js/21.8c354d40.js"><link rel="prefetch" href="/blog/assets/js/22.75f55fe6.js"><link rel="prefetch" href="/blog/assets/js/23.42ffa285.js"><link rel="prefetch" href="/blog/assets/js/24.adc41ea1.js"><link rel="prefetch" href="/blog/assets/js/25.e4d38764.js"><link rel="prefetch" href="/blog/assets/js/26.a3d230e3.js"><link rel="prefetch" href="/blog/assets/js/27.a783e661.js"><link rel="prefetch" href="/blog/assets/js/28.45f84a32.js"><link rel="prefetch" href="/blog/assets/js/29.ea384f66.js"><link rel="prefetch" href="/blog/assets/js/3.0b9ab56a.js"><link rel="prefetch" href="/blog/assets/js/30.1eb368ef.js"><link rel="prefetch" href="/blog/assets/js/31.9cf92f36.js"><link rel="prefetch" href="/blog/assets/js/32.8a7922cd.js"><link rel="prefetch" href="/blog/assets/js/33.315363ce.js"><link rel="prefetch" href="/blog/assets/js/34.bd4f53bc.js"><link rel="prefetch" href="/blog/assets/js/35.0123bb2b.js"><link rel="prefetch" href="/blog/assets/js/36.71f578fd.js"><link rel="prefetch" href="/blog/assets/js/37.ccf0be9f.js"><link rel="prefetch" href="/blog/assets/js/38.7103d33c.js"><link rel="prefetch" href="/blog/assets/js/39.b0fcef4a.js"><link rel="prefetch" href="/blog/assets/js/4.df9f6661.js"><link rel="prefetch" href="/blog/assets/js/40.42d79263.js"><link rel="prefetch" href="/blog/assets/js/41.a1891a81.js"><link rel="prefetch" href="/blog/assets/js/42.6820b732.js"><link rel="prefetch" href="/blog/assets/js/43.8d06ba2d.js"><link rel="prefetch" href="/blog/assets/js/44.edc3bd7b.js"><link rel="prefetch" href="/blog/assets/js/45.c6fbde69.js"><link rel="prefetch" href="/blog/assets/js/46.b337f6f4.js"><link rel="prefetch" href="/blog/assets/js/47.147e7400.js"><link rel="prefetch" href="/blog/assets/js/48.40546c7a.js"><link rel="prefetch" href="/blog/assets/js/49.57b44b08.js"><link rel="prefetch" href="/blog/assets/js/5.7ed68ab8.js"><link rel="prefetch" href="/blog/assets/js/51.a438fdcf.js"><link rel="prefetch" href="/blog/assets/js/52.cd31c8f7.js"><link rel="prefetch" href="/blog/assets/js/53.bd9b693e.js"><link rel="prefetch" href="/blog/assets/js/54.c01272c2.js"><link rel="prefetch" href="/blog/assets/js/55.9e8b945b.js"><link rel="prefetch" href="/blog/assets/js/56.9a35b94e.js"><link rel="prefetch" href="/blog/assets/js/57.92abf2a4.js"><link rel="prefetch" href="/blog/assets/js/58.2312acf4.js"><link rel="prefetch" href="/blog/assets/js/59.a930f904.js"><link rel="prefetch" href="/blog/assets/js/6.f9aed550.js"><link rel="prefetch" href="/blog/assets/js/60.813d2a6b.js"><link rel="prefetch" href="/blog/assets/js/61.936354b2.js"><link rel="prefetch" href="/blog/assets/js/62.a6c2dad3.js"><link rel="prefetch" href="/blog/assets/js/63.02d34422.js"><link rel="prefetch" href="/blog/assets/js/64.c3af1168.js"><link rel="prefetch" href="/blog/assets/js/65.4eed627a.js"><link rel="prefetch" href="/blog/assets/js/66.aa0f1bec.js"><link rel="prefetch" href="/blog/assets/js/67.2d16bb94.js"><link rel="prefetch" href="/blog/assets/js/68.c340f9db.js"><link rel="prefetch" href="/blog/assets/js/69.65e09da6.js"><link rel="prefetch" href="/blog/assets/js/7.9b5ca983.js"><link rel="prefetch" href="/blog/assets/js/70.ec19ec06.js"><link rel="prefetch" href="/blog/assets/js/71.88b52d32.js"><link rel="prefetch" href="/blog/assets/js/72.4d28525b.js"><link rel="prefetch" href="/blog/assets/js/73.6854e1be.js"><link rel="prefetch" href="/blog/assets/js/74.8fee1f77.js"><link rel="prefetch" href="/blog/assets/js/75.46242a0a.js"><link rel="prefetch" href="/blog/assets/js/76.b30b0bf4.js"><link rel="prefetch" href="/blog/assets/js/77.a732f835.js"><link rel="prefetch" href="/blog/assets/js/78.0f8806f5.js"><link rel="prefetch" href="/blog/assets/js/8.6467c411.js"><link rel="prefetch" href="/blog/assets/js/9.0289db1f.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.fe5bdb75.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="Warren's" class="logo"> <span class="site-name can-hide">Warren's</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/fe/" class="nav-link">前端</a></div><div class="nav-item"><a href="/blog/be/" class="nav-link">后端</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">笔记</a></div><div class="nav-item"><a href="/blog/other/" class="nav-link">其它</a></div><div class="nav-item"><a href="https://github.com/WarrenHewitt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/fe/" class="nav-link">前端</a></div><div class="nav-item"><a href="/blog/be/" class="nav-link">后端</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">笔记</a></div><div class="nav-item"><a href="/blog/other/" class="nav-link">其它</a></div><div class="nav-item"><a href="https://github.com/WarrenHewitt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>语言学习</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/note/language/javascript.html" class="sidebar-link">javascript</a></li><li><a href="/blog/note/language/html.html" class="sidebar-link">html</a></li><li><a href="/blog/note/language/css.html" class="sidebar-link">css</a></li><li><a href="/blog/note/language/react.html" class="sidebar-link">react</a></li><li><a href="/blog/note/language/vue.html" class="sidebar-link">vue</a></li><li><a href="/blog/note/language/web-app.html" class="sidebar-link">web-app</a></li><li><a href="/blog/note/language/typescript.html" class="sidebar-link">typescript</a></li><li><a href="/blog/note/language/mini-programe.html" class="sidebar-link">mini-programe</a></li><li><a href="/blog/note/language/node.html" class="sidebar-link">node</a></li><li><a href="/blog/note/language/java.html" class="sidebar-link">java</a></li><li><a href="/blog/note/language/python.html" class="sidebar-link">python</a></li><li><a href="/blog/note/language/mysql-mongo.html" class="sidebar-link">mysql-mongo</a></li><li><a href="/blog/note/language/nginx.html" class="sidebar-link">nginx</a></li><li><a href="/blog/note/language/docker.html" class="active sidebar-link">docker</a></li><li><a href="/blog/note/language/git.html" class="sidebar-link">git</a></li><li><a href="/blog/note/language/D3.html" class="sidebar-link">D3</a></li><li><a href="/blog/note/language/threeJs.html" class="sidebar-link">threeJs</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>综合</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/note/comprehensive/canvasAndSvg.html" class="sidebar-link">canvas和svg相关用法</a></li><li><a href="/blog/note/comprehensive/examination.html" class="sidebar-link">笔试</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/note/algorithm/algorithm.html" class="sidebar-link">算法实践</a></li><li><a href="/blog/note/algorithm/sort.html" class="sidebar-link">常见排序算法原理及JS代码实现</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="centeos-安装-docker"><a href="#centeos-安装-docker" class="header-anchor">#</a> centeos 安装 docker</h2> <p>官方教程 <code>https://docs.docker.com/engine/install/centos/</code></p> <div class="language-shell extra-class"><pre class="language-text"><code># 安装 yum-utils 包
yum install -y yum-utils

# 添加docker仓库
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo 
# 用阿里云的镜像更快
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

yum install docker-ce docker-ce-cli containerd.io

</code></pre></div><p>如果提示 containerd 提示版本过低 <code>https://download.docker.com/linux/</code> 下载最新版的 containerd.io 和其它的一些 docker 资源</p> <p>示例下载： <code>dnf install -y https://download.docker.com/linux/centos/8/x86_64/stable/Packages/containerd.io-1.3.7-3.1.el8.x86_64.rpm</code></p> <p>centos  重启后 需要重启 docker  <code>systemctl start docker.service | service docker start</code></p> <hr> <p>Is the docker daemon running ：报错解决办法 service docker start</p> <hr> <ul><li><p>镜像：是由一系列的只读的层构建，每一层对应DockerFile里面的声明构成</p></li> <li><p>容器： 与镜像的唯一区别在于容器的最上面那一层是可读可写的</p></li> <li><p>启动 docker 服务  <code>service docker start</code></p></li> <li><p><code>systemctl restart docker</code>  重启docker服务,systemctl命令它实际上将 service 和 chkconfig 这两个命令组合到一起</p></li></ul> <p>当运行容器时，使用的镜像如果在本地中不存在，docker 就会自动从 docker 镜像仓库中下载，默认是从 Docker Hub 公共镜像源下载</p> <ul><li><p><code>docker inspect containerName|containerID</code> 查看容器配置信息</p></li> <li><p><code>docker images</code> 查看本机的镜像</p></li> <li><p><code>docker ps</code> 查看容器 <code>-a</code> 查看所有容器 包括未运行的</p></li> <li><p><code>docker pull nginx:latest</code> 安装 Nginx 镜像：</p></li> <li><p><code>docker start|stop|restart containerName</code> 启动|关闭|重启容器</p></li> <li><p><code>docker kill -s KILL containerName</code> 杀掉一个运行中的容器 并向容器发送一个信号</p></li> <li><p><code>docker build ./ -t imageName:1.0.0</code> 利用 Dockerfile 创建镜像 -t 后，表示打的标签  name:tag 或者 name 格式  <strong>tag 不写默认为 latest</strong></p></li></ul> <p>基于路径./（当前路径）打包一个镜像，镜像的名字是 imageName ，版本号是1.0.0。会自动寻找Dockerfile来打包出一个镜像</p> <ul><li><p><code>docker create --name containerName imageName:tag</code> 使用镜像 imageName 创建一个容器 并命名为 containerName</p></li> <li><p><code>docker run --name containerName -d imageName:tag</code> ：创建一个容器,以后台模式启动,并命名为 containerName</p></li></ul> <div class="language- extra-class"><pre class="language-text"><code>-p 80:80 主机(宿主)端口:容器端口 容器端口默认80

-P 容器内部端口随机映射到主机的端口 【在服务器中一定要加上，否则默认的80端口无法访问】

-d 后台运行容器，并返回容器ID；

-v /data:/data    主机的目录 /data 映射到容器的 /data
</code></pre></div><ul><li><p><code>docker rm -f containName containName</code> 强制删除一个或多个容器</p></li> <li><p><code>docker image rm imageName:tag | docker rmi imageName:tag</code> 强制删除一个或多个容器</p></li></ul> <h2 id="docker-国内镜像"><a href="#docker-国内镜像" class="header-anchor">#</a> docker 国内镜像</h2> <h3 id="命令行"><a href="#命令行" class="header-anchor">#</a> 命令行</h3> <p>/etc/docker/daemon.json 创建或修改该文件，加如下内容，修改后重启 <code>systemctl restart docker.service</code></p> <div class="language- extra-class"><pre class="language-text"><code>{
    // 阿里云的账号是需要自己去注册然后生成的
    &quot;registry-mirrors&quot;: [
      &quot;http://docker.mirrors.ustc.edu.cn&quot;,
      &quot;https://almtd3fa.mirror.aliyuncs.com&quot;,
      &quot;https://3laho3y3.mirror.aliyuncs.com&quot;,
      &quot;http://hub-mirror.c.163.com&quot;
    ]
}
</code></pre></div><h3 id="客户端"><a href="#客户端" class="header-anchor">#</a> 客户端</h3> <p>打开docker桌面端 -&gt; settings -&gt; Docker Engine 添加如下配置</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 同上</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token property">&quot;insecure-registries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;registry.docker-cn.com&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;docker.mirrors.ustc.edu.cn&quot;</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="docker-安装-nginx"><a href="#docker-安装-nginx" class="header-anchor">#</a> docker 安装 nginx</h2> <p>方式一：Dockerfile</p> <div class="language-shell extra-class"><pre class="language-text"><code># 使用 Nginx 作为镜像
FROM nginx 

# # 将宿主机中的./index.html文件复制进容器里的 /usr/share/nginx/html/index.html(这个地址是固定的)
COPY ./index.html /user/share/nginx/html/index.html

# 容器对外暴露的端口
# 这只是一个声明，在运行时并不会因为这个声明应用就会开启这个端口的服务
# 如果改为 83 也要同步修改 nginx 的默认端口为 83 否则，不会生效
EXPOSE 80 
</code></pre></div><p>方式二：</p> <p><code>docker run -d --name nginx-a -p 2022:80 -v /home/cicd/nginx/conf.d/default.conf:/etc/nginx/conf.d/default.conf -v /home/cicd/nginx/html:/usr/share/nginx/html -v /home/cicd/nginx/log:/var/log/nginx nginx:latest</code></p> <p>这里一定都要配置  不然可能无法正常访问</p> <p>default.conf 简单配置</p> <div class="language- extra-class"><pre class="language-text"><code>server {
    listen       80;
    server_name  localhost;

    # location块
    location / {
        root   html;
        index  index.html index.htm;
    }
}
</code></pre></div><p>html 也要提前创建</p> <hr> <h3 id="宿主机访问虚拟机中的docker容器的服务"><a href="#宿主机访问虚拟机中的docker容器的服务" class="header-anchor">#</a> 宿主机访问虚拟机中的docker容器的服务</h3> <p>ifconfig 中的 docker0： 下的 dockerIP； ens33：下的 服务ip</p> <p>以管理员运行 cmd 执行： <code>route -p add dockerIP mask 255.255.0.0 服务IP</code>  mask 后的掩码，参考 docker0 netmask 后的掩码</p> <h3 id="进入-docker容器"><a href="#进入-docker容器" class="header-anchor">#</a> 进入 docker容器</h3> <div class="language- extra-class"><pre class="language-text"><code>docker exec -it 容器id或容器名称  /bin/bash   【表示进入容器的 /bin/bash 目录,固定这个地址进入，否则会报错】

-i 即使没有附加也保持STDIN（标准输入） 打开,以交互模式运行容器，通常与 -t 同时使用；
-t 为容器重新分配一个伪输入终端，通常与 -i 同时使用；

容器中无法使用 vim 在容器中执行以下命令

apt-get update

apt-get install vim

</code></pre></div><p>退出容器，输入 <code>exit</code></p> <h3 id="docker-容器群管理"><a href="#docker-容器群管理" class="header-anchor">#</a> docker 容器群管理</h3> <p>docker-compose  安装示例 https://docs.docker.com/compose/install/</p> <ul><li>docker-compose.yml 配置</li></ul> <div class="language-shell extra-class"><pre class="language-text"><code>version: '3'  # 这里要查看与 docker engin 对应的版本来修改
services:                                      # 集合
  docker_jenkins:
    user: root                                 # 避免一些权限问题 所以使用了root
    restart: always                            # 重启方式
    image: jenkins/jenkins:latest              # 指定服务所使用的镜像
    container_name: jenkins                    # 容器名称
    ports:                                     # 对外暴露的端口定义
      - 8080:8080
      - 50000:50000
    volumes:                                   # 卷挂载路径
      - /home/jenkins/jenkins_home/:/var/jenkins_home  # 映射 Jenkins 在容器中的文件
      - /var/run/docker.sock:/var/run/docker.sock
      - /usr/bin/docker:/usr/bin/docker                # 为了可以在容器内使用docker命令
      - /usr/local/bin/docker-compose:/usr/local/bin/docker-compose
  docker_nginx:
    restart: always
    image: nginx
    container_name: nginx
    ports:
      - 8090:80
      - 80:80
      - 433:433
    volumes:
      - /home/nginx/conf.d/:/etc/nginx/conf.d
      - /home/webserver/static/jenkins/dist/:/usr/share/nginx/html
</code></pre></div><p><code>docker-compose up -d</code>  后台创建并运行所有容器</p> <h2 id="jenkins-相关"><a href="#jenkins-相关" class="header-anchor">#</a> jenkins 相关</h2> <p>先下载镜像 <code>docker pull jenkins/jenkins</code>推荐这个库 jenkins/jenkins 官方维护； jenkins/jenkins:lts 表示长期支持</p> <ol><li><p>创建文件夹 <code>mkdir /var/jenkins_home</code> 用于映射容器中的文件,也是相当于当前容器的jenkins的安装目录</p></li> <li><p>添加权限 <code>chown -R 1000 /var/jenkins_home</code> 目录的拥有者为root用户，而容器中jenkins用户的 uid 为 1000</p></li> <li><p>创建和运行容器： <code>docker run -d --name containerName -p 2014:8080 -p 2015:50000 -v /var/jenkins_home:/var/jenkins_home jenkins/jenkins:latest</code>  容器的 8080 和 50000 端口是固定的 映射的 容器地址也是固定的</p></li></ol> <p>浏览器进入 2014端口 ； 如果是虚拟机， ip是 docker的ip； 有些虚拟机可以直接用，虚拟机的 ip （enp0s3 中的 IP）</p> <hr> <ul><li><p>jenkins 插件下载慢处理</p> <ol><li><p>先查找 jenkins 的安装目录下的 default.json 文件 不知道安装目录可以用 <code>find / -name default.json</code> 查找 一般在 /var/jenkins_home/updates/default.json</p></li> <li><p>替换文件中的内容，可以用命令
<code>sed -i 's/www.google.com/www.baidu.com/g' default.json</code> <code>sed -i 's/updates.jenkins-ci.org\/download/mirrors.tuna.tsinghua.edu.cn\/jenkins/g' default.json</code></p></li> <li><p>重启 jenkins （ 在浏览器 ip地址后加restart 跳转点击重启 ）</p></li></ol></li></ul> <p>或者是在页面中点击 插件管理 =&gt; 高级 最下面的url 源切换 https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</p> <ul><li>下载 jenkins 插件</li></ul> <div class="language- extra-class"><pre class="language-text"><code># docker exec -it jenkins-tutorials bash
# cd /var/jenkins_home/war/WEB-INF/detached-plugins
# wget http://ftp.icm.edu.pl/packages/jenkins/plugins/cloudbees-folder/6.9/cloudbees-folder.hpi

注意更换版本,在此查看 http://ftp.icm.edu.pl/packages/jenkins/plugins/cloudbees-folder/latest/cloudbees-folder.hpi
</code></pre></div><h3 id="配置-github-相关-实现代码更新，自动构建"><a href="#配置-github-相关-实现代码更新，自动构建" class="header-anchor">#</a> 配置 github 相关,实现代码更新，自动构建</h3> <ol><li><p>Jenkins 系统配置 启用Hook URL</p></li> <li><p>配置Github项目仓库；进入一个项目仓库，添加 webhook</p></li> <li><p>Jenkins 配置 github</p></li></ol> <p>具体的操作请网上搜索参考</p> <ul><li>SSH Publishers 配置</li></ul> <p>全局配置：</p> <p>Passphrase： 远程服务器的密码</p> <p>Hostname：远程服务器的ip地址</p> <p>Username： 远程服务器的账号名</p> <p>Remote Directory：要将文件发送到的远程服务器的目录</p> <p>构建后操作 -&gt; Send build artifacts over SSH</p> <p>Source files：源文件地址，地址的目录是相对于jenkins workspace的目录，如果只需要执行命令不需要传输文件的时候，此处可以为空，<strong>最好是一个打包后的文件</strong></p> <p>插件配置处，配置了具体的地址，这里的 Remote 相关的可以不填</p> <p>Exec command  在目标机器上执行的命令 要先进入目标文件 如下示例：</p> <div class="language- extra-class"><pre class="language-text"><code>cd /home/cicd/nginx/html/

tar -zxvf package.tar.gz

rm -rf package.tar.gz
</code></pre></div><h3 id="gitee"><a href="#gitee" class="header-anchor">#</a> gitee</h3> <ol><li><p>安装 jenkins</p></li> <li><p>安装插件 gitee</p></li> <li><p>配置 gitee 插件 ；点添加 选择 gitee api 令牌</p></li></ol> <ol start="3"><li>gitee 创建仓库</li></ol> <p>webhooks  需要域名或公共 ip</p> <p>Jenkins 的两个映射文件 /var/jenkins_home  和 /var/jenkins_home_gitee/</p> <p>Nginx 的映射文件 /home/cicd/nginx/</p> <p>安装 nodeJs 插件：  在 centos 上安装，再将安装地址 配置到Jenkins中</p> <p>构建 shell</p> <div class="language-shell extra-class"><pre class="language-text"><code>npm install --registry=https://registry.npm.taobao.org

npm run build

cd dist

tar -zcvf dist.tar.gz *

mv dist.tar.gz ..
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/note/language/nginx.html" class="prev">nginx</a></span> <span class="next"><a href="/blog/note/language/git.html">git</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.a3fab05b.js" defer></script><script src="/blog/assets/js/2.8013534f.js" defer></script><script src="/blog/assets/js/50.6c7a2ef7.js" defer></script>
  </body>
</html>
