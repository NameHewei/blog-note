<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Warren&#39;s</title>
    <meta name="description" content="blog &amp; note">
    <link rel="icon" href="/blog/favicon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.fe5bdb75.css" as="style"><link rel="preload" href="/blog/assets/js/app.a3fab05b.js" as="script"><link rel="preload" href="/blog/assets/js/2.8013534f.js" as="script"><link rel="preload" href="/blog/assets/js/58.2312acf4.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.53ff2caf.js"><link rel="prefetch" href="/blog/assets/js/11.4935f015.js"><link rel="prefetch" href="/blog/assets/js/12.d6ae9e0a.js"><link rel="prefetch" href="/blog/assets/js/13.26cdd5ab.js"><link rel="prefetch" href="/blog/assets/js/14.074ed238.js"><link rel="prefetch" href="/blog/assets/js/15.cc53453a.js"><link rel="prefetch" href="/blog/assets/js/16.b1284d0a.js"><link rel="prefetch" href="/blog/assets/js/17.4451e3ed.js"><link rel="prefetch" href="/blog/assets/js/18.fbfbe9e1.js"><link rel="prefetch" href="/blog/assets/js/19.a60c4380.js"><link rel="prefetch" href="/blog/assets/js/20.5f5ca6bc.js"><link rel="prefetch" href="/blog/assets/js/21.8c354d40.js"><link rel="prefetch" href="/blog/assets/js/22.75f55fe6.js"><link rel="prefetch" href="/blog/assets/js/23.42ffa285.js"><link rel="prefetch" href="/blog/assets/js/24.adc41ea1.js"><link rel="prefetch" href="/blog/assets/js/25.e4d38764.js"><link rel="prefetch" href="/blog/assets/js/26.a3d230e3.js"><link rel="prefetch" href="/blog/assets/js/27.a783e661.js"><link rel="prefetch" href="/blog/assets/js/28.45f84a32.js"><link rel="prefetch" href="/blog/assets/js/29.ea384f66.js"><link rel="prefetch" href="/blog/assets/js/3.0b9ab56a.js"><link rel="prefetch" href="/blog/assets/js/30.1eb368ef.js"><link rel="prefetch" href="/blog/assets/js/31.9cf92f36.js"><link rel="prefetch" href="/blog/assets/js/32.8a7922cd.js"><link rel="prefetch" href="/blog/assets/js/33.315363ce.js"><link rel="prefetch" href="/blog/assets/js/34.bd4f53bc.js"><link rel="prefetch" href="/blog/assets/js/35.0123bb2b.js"><link rel="prefetch" href="/blog/assets/js/36.71f578fd.js"><link rel="prefetch" href="/blog/assets/js/37.ccf0be9f.js"><link rel="prefetch" href="/blog/assets/js/38.7103d33c.js"><link rel="prefetch" href="/blog/assets/js/39.b0fcef4a.js"><link rel="prefetch" href="/blog/assets/js/4.df9f6661.js"><link rel="prefetch" href="/blog/assets/js/40.42d79263.js"><link rel="prefetch" href="/blog/assets/js/41.a1891a81.js"><link rel="prefetch" href="/blog/assets/js/42.6820b732.js"><link rel="prefetch" href="/blog/assets/js/43.8d06ba2d.js"><link rel="prefetch" href="/blog/assets/js/44.edc3bd7b.js"><link rel="prefetch" href="/blog/assets/js/45.c6fbde69.js"><link rel="prefetch" href="/blog/assets/js/46.b337f6f4.js"><link rel="prefetch" href="/blog/assets/js/47.147e7400.js"><link rel="prefetch" href="/blog/assets/js/48.40546c7a.js"><link rel="prefetch" href="/blog/assets/js/49.57b44b08.js"><link rel="prefetch" href="/blog/assets/js/5.7ed68ab8.js"><link rel="prefetch" href="/blog/assets/js/50.6c7a2ef7.js"><link rel="prefetch" href="/blog/assets/js/51.a438fdcf.js"><link rel="prefetch" href="/blog/assets/js/52.cd31c8f7.js"><link rel="prefetch" href="/blog/assets/js/53.bd9b693e.js"><link rel="prefetch" href="/blog/assets/js/54.c01272c2.js"><link rel="prefetch" href="/blog/assets/js/55.9e8b945b.js"><link rel="prefetch" href="/blog/assets/js/56.9a35b94e.js"><link rel="prefetch" href="/blog/assets/js/57.92abf2a4.js"><link rel="prefetch" href="/blog/assets/js/59.a930f904.js"><link rel="prefetch" href="/blog/assets/js/6.f9aed550.js"><link rel="prefetch" href="/blog/assets/js/60.813d2a6b.js"><link rel="prefetch" href="/blog/assets/js/61.936354b2.js"><link rel="prefetch" href="/blog/assets/js/62.a6c2dad3.js"><link rel="prefetch" href="/blog/assets/js/63.02d34422.js"><link rel="prefetch" href="/blog/assets/js/64.c3af1168.js"><link rel="prefetch" href="/blog/assets/js/65.4eed627a.js"><link rel="prefetch" href="/blog/assets/js/66.aa0f1bec.js"><link rel="prefetch" href="/blog/assets/js/67.2d16bb94.js"><link rel="prefetch" href="/blog/assets/js/68.c340f9db.js"><link rel="prefetch" href="/blog/assets/js/69.65e09da6.js"><link rel="prefetch" href="/blog/assets/js/7.9b5ca983.js"><link rel="prefetch" href="/blog/assets/js/70.ec19ec06.js"><link rel="prefetch" href="/blog/assets/js/71.88b52d32.js"><link rel="prefetch" href="/blog/assets/js/72.4d28525b.js"><link rel="prefetch" href="/blog/assets/js/73.6854e1be.js"><link rel="prefetch" href="/blog/assets/js/74.8fee1f77.js"><link rel="prefetch" href="/blog/assets/js/75.46242a0a.js"><link rel="prefetch" href="/blog/assets/js/76.b30b0bf4.js"><link rel="prefetch" href="/blog/assets/js/77.a732f835.js"><link rel="prefetch" href="/blog/assets/js/78.0f8806f5.js"><link rel="prefetch" href="/blog/assets/js/8.6467c411.js"><link rel="prefetch" href="/blog/assets/js/9.0289db1f.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.fe5bdb75.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="Warren's" class="logo"> <span class="site-name can-hide">Warren's</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/fe/" class="nav-link">前端</a></div><div class="nav-item"><a href="/blog/be/" class="nav-link">后端</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">笔记</a></div><div class="nav-item"><a href="/blog/other/" class="nav-link">其它</a></div><div class="nav-item"><a href="https://github.com/WarrenHewitt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/fe/" class="nav-link">前端</a></div><div class="nav-item"><a href="/blog/be/" class="nav-link">后端</a></div><div class="nav-item"><a href="/blog/note/" class="nav-link router-link-active">笔记</a></div><div class="nav-item"><a href="/blog/other/" class="nav-link">其它</a></div><div class="nav-item"><a href="https://github.com/WarrenHewitt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>语言学习</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/note/language/javascript.html" class="sidebar-link">javascript</a></li><li><a href="/blog/note/language/html.html" class="sidebar-link">html</a></li><li><a href="/blog/note/language/css.html" class="sidebar-link">css</a></li><li><a href="/blog/note/language/react.html" class="sidebar-link">react</a></li><li><a href="/blog/note/language/vue.html" class="sidebar-link">vue</a></li><li><a href="/blog/note/language/web-app.html" class="sidebar-link">web-app</a></li><li><a href="/blog/note/language/typescript.html" class="sidebar-link">typescript</a></li><li><a href="/blog/note/language/mini-programe.html" class="sidebar-link">mini-programe</a></li><li><a href="/blog/note/language/node.html" class="sidebar-link">node</a></li><li><a href="/blog/note/language/java.html" class="sidebar-link">java</a></li><li><a href="/blog/note/language/python.html" class="sidebar-link">python</a></li><li><a href="/blog/note/language/mysql-mongo.html" class="sidebar-link">mysql-mongo</a></li><li><a href="/blog/note/language/nginx.html" class="active sidebar-link">nginx</a></li><li><a href="/blog/note/language/docker.html" class="sidebar-link">docker</a></li><li><a href="/blog/note/language/git.html" class="sidebar-link">git</a></li><li><a href="/blog/note/language/D3.html" class="sidebar-link">D3</a></li><li><a href="/blog/note/language/threeJs.html" class="sidebar-link">threeJs</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>综合</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/note/comprehensive/canvasAndSvg.html" class="sidebar-link">canvas和svg相关用法</a></li><li><a href="/blog/note/comprehensive/examination.html" class="sidebar-link">笔试</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/note/algorithm/algorithm.html" class="sidebar-link">算法实践</a></li><li><a href="/blog/note/algorithm/sort.html" class="sidebar-link">常见排序算法原理及JS代码实现</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#介绍">介绍</a></li><li><a href="#安装">安装</a></li><li><a href="#配置文件">配置文件</a><ul><li><a href="#关于-location-的路径映射">关于 location 的路径映射</a></li></ul></li><li><a href="#反向代理">反向代理</a></li><li><a href="#负载均衡">负载均衡</a></li><li><a href="#动静分离">动静分离</a></li><li><a href="#集群">集群</a></li></ul></div>
[toc]<p></p> <h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <p>Nginx 是介于客户端与服务端的</p> <blockquote><p>特点：
1. 稳定性极强, 7*24小时不间断运行
2. 丰富的配置示例
3. 占用内存小，并发能力强（50000以上并发）</p></blockquote> <p>tomcat 150个并发</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <p>windows 安装：</p> <ul><li>下载，解压到任意目录，进入包含 <code>Nginx.exe</code> 的目录，打开命令窗口，进入到该目录，运行 <code>start nginx</code></li></ul> <p>如果启动失败 可以进入 logs 文件夹中的 error.log 文件产看是否有错误原因</p> <p>启动成功后在任务管理器可以看到 nginx 的进程</p> <ul><li>浏览器访问 <code>http://127.0.0.1/</code>  或 <code>locahost</code></li></ul> <p>其它的一些操作</p> <div class="language- extra-class"><pre class="language-text"><code>nginx -s stop 立即停止nginx,不保存相关信息

nginx -s quit 正常退出nginx,并保存相关信息

nginx -s reload 重启: 改变了配置等
</code></pre></div><hr> <h2 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h2> <blockquote><p>root 与 alias 的区别:</p></blockquote> <p>主要在于怎么解释 location 后面的 url</p> <p>root的处理结果是：root路径＋location路径</p> <p>alias的处理结果是：使用alias路径替换location路径 （注意alias后面视情况是否要用 '/' 结束）</p> <p>示例： 假设访问地址是 /t/x.html</p> <div class="language-shell extra-class"><pre class="language-text"><code>location /t/ {
    root http://www.xx.xx/   
    # 映射为  http://www.xx.xx/t/x.html

    alias http://www.xx.xx/   
    # 映射为  http://www.xx.xx/x.html
}   
</code></pre></div><hr> <ul><li><p>一个 server 块中可以有多个 location</p></li> <li><p>更多默认配置和查看新安装的 Nginx 的 nginx.conf 文件</p></li></ul> <div class="language-shell extra-class"><pre class="language-text"><code>
#user  nobody;
worker_processes  1;
#pid        logs/nginx.pid;


# 以上为全局块 
# worker_processes 数值越大，Nginx 并发能力越强
# error_log  错误日志存放的位置
# pid  一般不用关注  Nginx 运行的标志

events {
    worker_connections  1024;
}

# events块  
# worker_connections 数值越大，Nginx 并发能力越强（这里的数据值一般是运维人员根据服务器来配置， worker_processes 也是如此）


# 以下为http块
# include 引入一个外部的文件 mime.types 里面放着大量的媒体类型

http {
    include       mime.types;
    # 这里是默认使用的媒体类型
    default_type  application/octet-stream;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;
    gzip on;

    # 禁止IE使用gzip 以免假死
    gzip_disable &quot;MSIE [1-6].&quot;;

    # 不压缩小于256字节的文件
    gzip_min_length 256; 

    # gzip_vary on;
    # gzip_proxied any;

    # gzip压缩比，1压缩比最小处理速度最快，9压缩比最大但处理速度最慢(传输快但比较消耗cpu)
    gzip_comp_level 2;
    
    # gzip_buffers 16 8k;
    # gzip_http_version 1.1;

    # 表示压缩的文件类型
    # gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;



    # server块
    # 这里的server块也可以通过 include 方式加载，可将server块独立开来，因为后期主要修改几乎为server块
    server {
        # Nginx 监听的端口号
        listen       80;
        # Nginx接收请求的的域名
        server_name  localhost;

        # location块
        location / {
            # 重定向到指定地址
            # proxy_pass http://localhost:2500/page/one;
            
            # 将接收到的请求，根据 html  这个地址去查找静态资源
            root   html;
            # 默认去上面的路径中查找 index.html 或者 index.htm
            index  index.html index.htm;
        }
    }
}
</code></pre></div><h3 id="关于-location-的路径映射"><a href="#关于-location-的路径映射" class="header-anchor">#</a> 关于 location 的路径映射</h3> <p>优先级：</p> <p>(location = ) &gt; (location /xxx/xx/x) &gt; (location ^~) &gt; (location ~, ~*) &gt; (location /起始路劲) &gt; (location /)</p> <ol><li><code>=</code> 匹配</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>location = / {
    # 精准匹配 主机域名后面不能带任何的字符串
}
</code></pre></div><ol start="2"><li>通用匹配</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>location /xxx {
    # 匹配所有以 /xxx 开头的路径
}
</code></pre></div><ol start="3"><li>正则匹配</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>location ~/xxx {
    # 匹配所有以 /xxx 开头的路径
}
</code></pre></div><ol start="4"><li>匹配开头路径</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>location ^~/xxx {
    # 匹配所有以 /xxx 开头的路径
}
</code></pre></div><ol start="5"><li>匹配结尾</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>location ~* \.(gif|jpg)$ {
    # 匹配所有以 .gif 或 .jpg 结尾的路径
}
</code></pre></div><h2 id="反向代理"><a href="#反向代理" class="header-anchor">#</a> 反向代理</h2> <p>正向代理:</p> <ol><li>代理服务器是由客户端设立的</li> <li>客户端了解代理服务器和目标服务器是谁</li> <li>帮助实现突破访问权限、提高访问速度、对目标服务器隐藏客户端的ip</li></ol> <p>反向代理:</p> <ol><li>反向代理服务器放在服务端</li> <li>客户端不知道访问的是哪一台服务器</li> <li>达到负载均衡，并且可以隐藏服务器的真正ip</li></ol> <h2 id="负载均衡"><a href="#负载均衡" class="header-anchor">#</a> 负载均衡</h2> <p>根据相应的算法决定请求是发给哪个服务器</p> <p>处理策略：</p> <ol><li>轮询
轮流给每一个服务器派发 客户端的请求，平均分配</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>upstream myServer {
    # server ip:port;
    server localhost:2500;
    server localhost:1112;
}
server {
    location / {
        proxy_pass http://myServer;
    }
}
</code></pre></div><ol start="2"><li>权重
根据具体的服务器的处理能力，派发客户端的请求</li></ol> <p>只需加上 weight</p> <div class="language-shell extra-class"><pre class="language-text"><code>upstream myServer {
    server localhost:2500 weight=10;
    server localhost:1112 weight=2;
}
</code></pre></div><ol start="3"><li>ip_hash
对请求ip 进行相关的处理，然后请求指定的服务器，如果ip 不变，请求的服务器将一直不变</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>upstream myServer {
    ip_hash;
    # 下面是否加权重与 ip_hash无关
    server localhost:2500 weight=10;
    server localhost:1112 weight=2;
}
</code></pre></div><h2 id="动静分离"><a href="#动静分离" class="header-anchor">#</a> 动静分离</h2> <p>动态资源 静态资源 分离</p> <p>动态资源交给服务器，静态资源自己处理</p> <p>Nginx 并发能力公式： <code>worker_processes * worker_connections / (4 | 2)</code> = 最终并发能力</p> <p>动态资源除以4（因为多了请求服务器数据和接收服务器数据），静态资源除以2</p> <ol><li>动态资源代理</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>location / {
    proxy_pass  url;
}
</code></pre></div><ol start="2"><li>静态资源代理</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>location / {
    root 静态资源路径;
    index  默认访问路径下的什么资源;
    autoindex on; # 表示展示静态资源全部内容 以列表的形式
}

# 存在目录 /static/static 和 /static/image 
# 以下配置生效
location /static {
    root static;
    index index.html;
}

location /image {
    root static;
    autoindex on;
}
</code></pre></div><h2 id="集群"><a href="#集群" class="header-anchor">#</a> 集群</h2> <p>搭建集群后，使用Nginx做反向代理服务器</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/note/language/mysql-mongo.html" class="prev">mysql-mongo</a></span> <span class="next"><a href="/blog/note/language/docker.html">docker</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.a3fab05b.js" defer></script><script src="/blog/assets/js/2.8013534f.js" defer></script><script src="/blog/assets/js/58.2312acf4.js" defer></script>
  </body>
</html>
